# Linuxサーバーの概要
本教科書では、Linuxをインストールし、サーバー環境を構築する実習をしながら、LinuCレベル2の範囲の理解と取得を目指します。第1章では、Linuxサーバーの概要について解説し、2章以降に行う実習に必要な環境と知識の確認を行います。

## 用語集
### Linux
Linus Torvalds氏により開発された、UNIX互換を目指したOSの総称をLinuxといいます。ソースコードは公開されており、世界中の開発者の協力により、日々開発が継続されています。

### ディストリビューション
Linuxは狭い意味ではOSの中心部（＝カーネル）のみを指しますが、Linuxカーネルだけではシステムは動作しません。カーネル以外のさまざまなソフトウェアやインストーラを追加して、利用できるようにしたのがディストリビューションです。ディストリビューションごとに開発方針があり、それに沿ってソフトウェアがまとめられたり、リリースが行われています。

### AlmaLinux
Linuxのディストリビューションの1つです。Red Hat Enterprise Linuxという商用のディストリビューション互換の環境を無償で提供しているディストリビューションで、AlmaLinuxコミュニティによって開発されています。

### IPアドレス
インターネットにおいて、IPで通信が行われる場合、端末一つ一つにIPアドレスが割り当てられます。IPアドレスとはインターネット上での端末の所在地を示す「住所」にあたります。
現在ではIPv4とIPv6の2種類がありますが、本教科書ではIPv4を使います。

### サブネットマスク
IPアドレスのうちネットワークアドレス部とホストアドレス部を識別するための数値のことをいいます。32ビットのIPアドレスを、8ビット毎に.(ドット)で区切って10進数で表記します。

### ネットワークアドレス
IPネットワークを小さく分割して利用するときに、ネットワークアドレス部とホストアドレス部に分かれます。ネットワークアドレスの識別に利用されるのが、ネットワークアドレス部です。

### DNSサーバーアドレス
IPアドレスとFQDN（＝ホスト名＋ドメイン名）の変換を行うのがDNSサービスであり、そのサービスを提供するDNSサーバーのIPアドレスのことです。

### ホスト名
ネットワークに接続されたコンピューターに割り当てられた名称のことをいいます。特定のホストを識別するために使われます。

### ドメイン名
インターネット上に存在するコンピューターやネットワークを識別するために付けらている名前の一種のことをいいます。ドメイン名はアルファベット、数字、一部の記号の組み合わせで構成されますが、日本語.jp のような国際化ドメインも使われるようになっています。

### DVD
光学メディアの1種類で、ビデオ再生での利用で普及し、現在ではデータ記録の用途でも利用されています。約700MBのCD-ROMに比べ、約4.7GBと大容量でも利用できることから、OSのインストールディスクとしても利用されています。

### ハードディスク
磁気を用いた記憶媒体であり、パソコンの記憶媒体の他、音楽プレーヤー、ビデオなどの記憶媒体としても用いられています。

### SSD
半導体メモリであるフラッシュメモリを用いた記憶媒体であり、ハードディスクよりも読み書きの処理性能に優れています。

### LVM
LVM（Logical Volume Manager）とは，複数のハードディスクやパーティションにまたがった記憶領域を一つの論理的なディスクとして扱うことのできるディスク管理の機能のことです。LinuxをはじめとしたUNIX系OS上で利用できます。

### RAID
複数のハードディスクをまとめて1台のハードディスクとして管理する技術のことです。
RAIDを使うことによりデータを分散して記録するため、高速化や安全性の向上が期待できます。RAIDの方法には、専用のハードウェアを使う方法（ハードウェアRAID）とソフトウェアで実現する方法（ソフトウェアRAID）があり、高速性や安全性のレベルにより、RAID 0やRAID 5などいくつかの種類があります。

## 実習で利用するハードウェア
本教科書の実習では、仮想マシンを使って実習環境を構築します。仮想マシンの詳細については次章で解説しますが、ここでは実習用に用意するハードウェアの仕様などについて解説します。

### マシン本体
WindowsやLinux、macOSが動作する、いわゆる「パソコン」（PC）を想定しています。用意したPCに「VirtualBox」のような仮想マシンソフトウェアをインストールして実習環境を構築します。

### CPU
実習ではCPU負荷の高い処理は行わないため、高性能なCPUは必要ありません。ただし、仮想マシンを実行するために仮想化支援技術が必要となります。古いCPUでない限り仮想化支援技術を備えていますが、BIOS（UEFI）で有効にする必要があります。

### 実装メモリ
AlmaLinux 9.2では1.5GBのメモリが推奨されています。DNSやメールの実習では2台の仮想マシンを使って実習を行うので、3GBの空きメモリが必要です。メモリは仮想マシンの他に、OS（ホストOSと呼ぶ）やその他のアプリケーションを同時に動作させるために必要となるので、最低でも8GB、快適に実習を行うには16GB以上のメモリが搭載されていることが望ましいでしょう。メモリの搭載量が少ない場合には、仮想マシンへのメモリの割り当てを減らしたり、余計なアプリケーションを動作させないようにするなどのメモリ効率改善や、メモリスワップ発生による速度低下を許容する必要があります。

### ハードディスクやSSDなどのストレージ
仮想マシンが使用する仮想ハードディスクはファイルとしてPCに接続されたストレージに保管されます。仮想ハードディスクファイルは使用した分だけストレージを消費します。実習で使用する環境はおよそ7GBの容量を消費します。デフォルトでは最大20GBの仮想ハードディスクファイルが作られるので、2台の仮想マシンで少なくとも14GB、最大40GBの容量を用意しておく必要があります。
仮想ハードディスクファイルの読み書きは頻繁に行われるため、ハードディスクよりも高速なSSDを使用するのが望ましいでしょう。

### ネットワーク
実習ではインターネットに接続できる必要がありますが、実習用に用意するPCは有線LAN、無線LAN、どちらの方式で接続されていても構いません。

## 利用するLinuxのディストリビューション
本教科書では、AlmaLinux 9.2の64ビット版を利用します。

```
https://almalinux.org/ja/
```

AlmaLinuxは、商用ディストリビューションであるRed Hat Enterprise Linuxをベースにしたディストリビューションとして提供されています。利用に際し費用が発生しない、無償で提供されているディストリビューションです。

### インストール用ISOイメージの入手
AlmaLinuxが配布しているISOイメージを、ダウンロードします。仮想マシンは、ISOイメージを仮想光学ドライブにセットすることでインストールが行えるので、インストール用のDVD/USBメモリを作成する必要がありません。

#### ダウンロード方法
ISOイメージをダウンロードするには、以下のURLにアクセスします。

```
https://mirrors.almalinux.org/isos/x86_64/9.2.html
```

このURLにアクセスすると、多くのミラーサイトが表示されます。例えば、IIJが提供しているミラーサイトのURLであれば次のようになります。

```
http://ftp.iij.ad.jp/pub/linux/almalinux/9.2/isos/x86_64/
```

#### URLが利用できない場合
URLはサイト構造の変更によって変わっている場合があります。その場合には、AlmaLinuxのWebサイトからリンクを辿ってダウンロードサイトを探してください。

## ISOイメージのファイル名
ISOイメージは以下のようなファイル名になっています。

AlmaLinux-バージョン-アーキテクチャ-イメージの種類.iso

### バージョン
本教科書では、本教科書の作成時点で最新であったAlmaLinux 9.2を利用した構築方法について解説しています。今後のバージョンアップで、より新しいバージョンのAlmaLinuxが入手可能になっているかもしれません。バージョン9系であればマイナーバージョンによる大きな差は無いので同様の手順でサーバーの構築ができると推測されますが、セキュリティ対応などの関係でデフォルトの設定が変更されることで動作が変わる場合があります。

初めて本教科書の内容を学習する際には、まずはバージョンを合わせて動作を確認し、その後異なるバージョンで同様に動作するか確認してみてください。バージョンによる動作の違いについては、本教科書の情報交換を行うSlackで情報共有したり、今後の本教科書のバージョンアップなどで対応していく予定です。

### アーキテクチャ
Linuxカーネルは様々な種類のCPUアーキテクチャに対応しています。アーキテクチャによってバイナリーが異なるため、アーキテクチャに合わせたISOイメージを選択する必要があります。主なアーキテクチャには以下のものがあります。

#### x86_64
IntelやAMDのCPUアーキテクチャです。64ビット版になります。

#### aarch64
ARMのCPUアーキテクチャです。64ビット版になります。

この他にPowerPC(ppc64le)や、IBM S/390(s390x)などのアーキテクチャに対応したISOイメージが用意されています。

### ISOイメージの種類
ISOイメージには、いくつかの種類があります。インストールの目的によってイメージを選択します。AlmaLinuxには以下の3種類のISOイメージが用意されています。
本教科書の演習では、GUI環境も使用するため、フルインストールが可能なISOイメージ（dvd.iso）を使ってインストールします。AlmaLinux-9.2-x86_64-dvd.isoをダウンロードしてください。
実務では最小限のインストールを行い、必要なパッケージを追加してサーバーを構築することが多いので、慣れてきたら最低限のOSインストールを行うISOイメージ（minimal.iso）からインストールを行う方法にも挑戦してみてください。

#### boot.iso
インストーラーの起動のみを行うISOイメージです。インストールするファイルをネットワーク経由で取得するネットワークインストールを行います。システムに障害が発生した際に復旧を行うレスキューモードで起動するためにも使用できます。
最低限の構成になっているので、ISOイメージのサイズは小さくなっています。

#### minimal.iso
最低限のOSインストールを行うISOイメージです。DVDメディアの容量制限に引っかからないため、DVDメディアを作成してインストールを行うにはこちらを選択します。

#### dvd.iso
フルインストールが可能なISOイメージです。サイズが大きいため、DVDメディアを作成することができません。USBメモリに書き込むか、仮想マシンにインストールする場合には利用可能です。

## ネットワーク環境について
本教科書では仮想マシンを利用して実習を行うため、特別なネットワークは必要ありませんが、以下の点について確認しておいてください。

### インターネットへの接続
ソフトウェアのインストールを行うため、インターネット上に用意されているリポジトリサーバーへのアクセスが必要になります。用意した実習用PCがインターネットに接続できていれば、実習環境からインターネットに接続するための特別な設定は必要ありません。
プロキシーを経由して接続する必要がある場合には、接続のための設定情報を入手したり、ネットワーク管理者に相談してください。

### 仮想マシン間の接続
仮想マシン間の接続は仮想ネットワークを経由して行うため、利用している仮想マシンソフトウェアの仕様によって異なります。本教科書で利用するVirtualBoxはホストオンリーネットワーク接続を行うため、仮想マシン同士とホストOSのみしか相互に接続できず、外部のネットワークからは隔離されているため、IPアドレスなどは独自に設定できます。

### サーバーに割り当てるIPアドレスなどの値
サーバー間での接続のためにネットワークを利用します。ネットワークの設定項目は複数ありますので、あらかじめIPアドレスなどを決めておくとよいでしょう。

## ネットワークの設定項目
### ドメイン名
ドメイン名は、DNSサーバーを設定するときに必要になります。このドメイン名は、あくまでこのネットワーク内のみで有効なドメイン名で、外部のDNSとは隔離された状態にあります。

本教科書では、2台の仮想マシンのためにalpha.jpとbeta.jpの2つを使用します。

### ホスト名
自分のPCに設定するホスト名です。ドメイン名に合わせてserverAとserverBと設定します。

ホスト名は、ドメイン名と合わせてFQDN(Fully Qualified Domain Name)で記述する場合もあります。FQDN表記の場合には、それぞれ以下のようになります。

serverA.alpha.jp
serverB.alpha.jp

#### ホスト名の大文字小文字の区別
Linuxではホスト名の大文字小文字の区別はありません。本教科書では見分けやすくするため、AとBを大文字で表記しています。

### IPアドレス
IPアドレスは、VirtualBoxのホストオンリーネットワーク接続のデフォルトに合わせて、それぞれ以下のように設定しています。

serverA：192.168.56.101
serverB：192.168.56.102

### サブネットマスク
サブネットマスクは、IPアドレスのネットワーク部とホスト部を分ける値です。本教科書では255.255.255.0(/24)とします。

### ネットワークアドレス
ネットワークアドレスは、PCが含まれているネットワーク全体を示すアドレスです。本教科書では192.168.56.0とします。

### デフォルトゲートウエイ
異なるサブネットとの通信に必要な値です。ホストオンリーネットワーク接続では外部への接続を行わないため、デフォルトゲートウェイは設定しません。実際のサーバー構築においては、ネットワークの設定を確認の上、適切なデフォルトゲートウェイのアドレスを確認、設定してください。

### DNSサーバーアドレス
ホスト名とIPアドレスの対応を解決する、DNS（ドメインネームシステム）という機構があります。DNSを利用するためにはDNSサーバーのIPアドレスが必要です。

本教科書ではx章で、実際にDNSサーバーを設定し動作させます。実習ではまず自分自身で動作させているDNSサーバーを参照するため、DNSサーバーアドレスを自分のIPアドレスとします。

serverA：192.168.56.101
serverB：192.168.56.102
